<!DOCTYPE html>
<html>
<head>
  <title>Sync APIs</title>
</head>
<body>
  <h2>Sincronizando dados...</h2>
  <script>
    async function syncData() {
      const api1 = 'https://chatgpt-api-9a719-default-rtdb.firebaseio.com/api/chat/per.json';
      const api2 = 'https://server-chatgpt-api-default-rtdb.firebaseio.com/api/chat/per.json';
      const api3 = 'https://server-chatgpt-api-default-rtdb.firebaseio.com/api/chat/res.json';
      const api4 = 'https://chatgpt-api-9a719-default-rtdb.firebaseio.com/api/chat/res.json';

      try {
        // 1. Pegar dados do api1 e enviar para api2
        const data1 = await fetch(api1).then(res => res.json());
        await fetch(api2, {
          method: 'PUT',
          body: JSON.stringify(data1)
        });

        // 2. Pegar dados do api3 e enviar para api4
        const data2 = await fetch(api3).then(res => res.json());
        await fetch(api4, {
          method: 'PUT',
          body: JSON.stringify(data2)
        });

        // 3. Aguardar 5 segundos e limpar api2
        setTimeout(async () => {
          await fetch(api2, {
            method: 'PUT',
            body: JSON.stringify("") // ou null
          });

          document.body.innerHTML += '<p>Dados sincronizados e limpos com sucesso.</p>';

          // Redireciona após limpeza
          setTimeout(() => {
            window.location.href = "https://api-chatgpt.github.io/ChatGPT-Api/filtragem.html";
          }, 1000);

        }, 5000);

      } catch (err) {
        console.error(err);
        document.body.innerHTML += '<p>Erro na sincronização.</p>';
      }
    }

    syncData();
  </script>
</body>
</html>